<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">

<dom-module id="my-fire">
  <template>
    <style>
      paper-icon-button {
        --paper-icon-button-ink-color: white;
      }
    </style>
    
    <firebase-app
      api-key="AIzaSyDwrbEx_4RHcIUVfMAZgLN4edNoRo-tlvw"
      auth-domain="sample-3-d794e.firebaseapp.com"
      storage-bucket="sample-3-d794e.appspot.com"
      database-url="https://sample-3-d794e.firebaseio.com"></firebase-app>
    <firebase-query path="/data" data="{{pages}}"></firebase-query>
    <firebase-auth signed-in="{{login}}" provider="google"></firebase-auth>

    <paper-icon-button icon="my:[[_icon(login)]]" on-tap="_auth"></paper-icon-button>
    
  </template>
  <script>
    class MyFire extends Polymer.Element {
      static get is() { return 'my-fire' }
      static get properties() {
        return {
          key: String,
          pages: {
            type: Array,
            notify: true
          },
          contents: {
            type: String,
            observer: '_contentsChanged'
          },
          login: {
            type: Boolean,
            notify: true
          }
        }
      }
      _icon(login){ return login ? 'logout' : 'google' }
      _auth(){
        const auth = this.shadowRoot.querySelector('firebase-auth')
        auth.signedIn ? auth.signOut() : auth.signInWithRedirect()
      }
    }
    customElements.define(MyFire.is, MyFire)
  </script>
</dom-module>
